<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Love Story - Happy Valentine's Day</title>
    <link href="https://fonts.googleapis.com/css2?family=Mali:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --pink-pastel: #FFC0CB;
            --cream: #FFF5F5;
            --soft-red: #FF6B81;
            --dark-pink: #e85a71;
            --white: #ffffff;
            --shadow: 0 10px 30px rgba(0,0,0,0.08);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Mali', cursive;
            background-color: var(--cream);
            color: #4a4a4a;
            overflow-x: hidden;
            line-height: 1.6;
            transition: background-color 0.5s ease;
        }

        /* Scroll Snapping ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏£‡∏∏‡∏õ */
        .full-view-mode {
            scroll-snap-type: y mandatory;
            overflow-y: scroll;
            height: 100vh;
        }

        .hidden { display: none !important; }
        
        .fade-in { animation: fadeIn 0.8s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Progress Bar */
        #progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: rgba(255,192,203,0.2);
            z-index: 1100;
        }
        #progress-bar {
            width: 0%;
            height: 100%;
            background: var(--soft-red);
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Splash Screen */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--pink-pastel), var(--cream));
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1200;
            text-align: center;
            transition: opacity 0.5s ease;
        }

        .btn-main {
            background-color: var(--soft-red);
            color: white;
            border: none;
            padding: 16px 32px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 107, 129, 0.3);
            font-family: 'Mali', cursive;
            font-weight: bold;
            transition: all 0.3s ease;
            margin-top: 20px;
            width: 80%;
            max-width: 280px;
        }
        .btn-main:hover { background-color: var(--dark-pink); transform: translateY(-2px); }
        .btn-main:active { transform: scale(0.95); }
        .btn-next { background-color: var(--dark-pink); margin-top: 30px; animation: pulse 2s infinite; }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(232, 90, 113, 0.4); }
            70% { box-shadow: 0 0 0 15px rgba(232, 90, 113, 0); }
            100% { box-shadow: 0 0 0 0 rgba(232, 90, 113, 0); }
        }

        /* Step Content */
        .step-content {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 60px 24px;
            text-align: center;
            scroll-snap-align: start;
            width: 100%;
        }

        .section-card {
            background: white;
            padding: 30px 24px;
            border-radius: 30px;
            width: 100%;
            max-width: 450px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }

        /* Timeline Style */
        .timeline-box {
            border-left: 3px dashed var(--pink-pastel);
            padding-left: 20px;
            text-align: left;
            margin: 20px 0;
        }
        .timeline-item { margin-bottom: 25px; position: relative; }
        .timeline-item::before {
            content: '‚ù§';
            position: absolute;
            left: -31px;
            top: 0;
            background: var(--cream);
            color: var(--soft-red);
            padding: 2px;
        }

        /* Game Grid */
        .game-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            width: 100%;
            max-width: 360px;
            margin: 25px 0;
        }
        .card {
            aspect-ratio: 1/1;
            background: var(--pink-pastel);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            transform-style: preserve-3d;
        }
        .card.flipped { transform: rotateY(180deg); background: white; border: 2px solid var(--pink-pastel); }
        .card .front, .card .back { position: absolute; backface-visibility: hidden; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; }
        .card .back { transform: rotateY(180deg); }

        /* Slider */
        .slider-container { width: 100%; max-width: 400px; overflow: hidden; border-radius: 25px; box-shadow: var(--shadow); position: relative; }
        .slider-track { display: flex; transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
        .slide { min-width: 100%; height: 300px; display: flex; align-items: center; justify-content: center; font-size: 5rem; background: #fdfdfd; }
        .slide img { width: 100%; height: 100%; object-fit: cover; border-radius: 25px; }

        /* Gift Animation */
        .gift-box { font-size: 7rem; cursor: pointer; transition: 0.3s; filter: drop-shadow(0 10px 15px rgba(0,0,0,0.1)); }
        .gift-box:hover { transform: scale(1.1); }
        .gift-box.open { animation: bounceIn 0.8s ease forwards; }

        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); }
        }

        /* Final Header */
        .final-header {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            scroll-snap-align: start;
            background: linear-gradient(to bottom, var(--white), var(--cream));
            text-align: center;
            padding: 20px;
        }

        /* UI Elements */
        .audio-toggle { position: fixed; bottom: 25px; right: 25px; background: white; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: var(--shadow); z-index: 1000; cursor: pointer; border: 2px solid var(--cream); }
        .floating-heart { position: fixed; pointer-events: none; z-index: 999; animation: floatUp 2.5s ease-out forwards; font-size: 1.5rem; }
        @keyframes floatUp { 
            0% { transform: translateY(0) scale(1) rotate(0); opacity: 1; } 
            100% { transform: translateY(-150px) scale(2) rotate(45deg); opacity: 0; } 
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-10px);}
            60% {transform: translateY(-5px);}
        }
    </style>
</head>
<body>

    <div id="progress-container" class="hidden"><div id="progress-bar"></div></div>

    <!-- Splash Screen -->
    <div id="splash-screen">
        <div style="font-size: 5.5rem; filter: drop-shadow(0 10px 10px rgba(0,0,0,0.1));">üíù</div>
        <h1 style="color: var(--dark-pink); margin-top: 15px; font-size: 2rem;">Our Love Story</h1>
        <p style="color: #888; margin-top: 5px;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏™‡∏≠‡∏á‡∏Ñ‡∏ô</p>
        <button class="btn-main" onclick="startStory()">üíó ‡∏Å‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</button>
    </div>

    <!-- Audio Toggle -->
    <div class="audio-toggle hidden" id="music-btn" onclick="toggleMusic()">üîá</div>
    <audio id="bg-music" loop>
        <source src="mp3/Valentines.mp3" type="audio/mpeg">
    </audio>

    <div id="story-container" class="hidden">
        
        <!-- Step 1: Timeline -->
        <div id="step-1" class="step-content">
            <h2 style="color: var(--dark-pink); margin-bottom: 20px;">‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ üóìÔ∏è</h2>
            <div class="section-card">
                <div class="timeline-box">
                    <div class="timeline-item">
                        <p style="font-weight: bold; color: var(--soft-red);">‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏Å‡∏±‡∏ô</p>
                        <p style="font-size: 0.9rem;">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏à‡∏≠‡πÄ‡∏ò‡∏≠ ‡∏¢‡∏±‡∏á‡∏à‡∏≥‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏•‡∏∑‡∏°‡πÄ‡∏•‡∏¢</p>
                    </div>
                    <div class="timeline-item">
                        <p style="font-weight: bold; color: var(--soft-red);">‡πÄ‡∏î‡∏ó‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</p>
                        <p style="font-size: 0.9rem;">‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å ‡∏°‡∏±‡∏ô‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î‡πÑ‡∏ß‡πâ‡∏°‡∏≤‡∏Å</p>
                    </div>
                    <div class="timeline-item" style="margin-bottom: 0;">
                        <p style="font-weight: bold; color: var(--soft-red);">‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</p>
                        <p style="font-size: 0.9rem;">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡∏Å‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÅ‡∏•‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡∏µ‡∏ô‡∏∞</p>
                    </div>
                </div>
            </div>
            <button class="btn-main btn-next" onclick="goToStep(2)">‡∏ï‡πà‡∏≠‡πÑ‡∏õ: ‡∏ó‡∏≥‡πÑ‡∏°‡∏â‡∏±‡∏ô‡∏ñ‡∏∂‡∏á‡∏£‡∏±‡∏Å‡πÄ‡∏ò‡∏≠ ‚ú®</button>
        </div>

        <!-- Step 2: Reasons -->
        <div id="step-2" class="step-content hidden">
            <h2 style="color: var(--dark-pink); margin-bottom: 20px;">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡πÄ‡∏ò‡∏≠ üíå</h2>
            <div class="section-card">
                <div id="reason-box" style="min-height: 120px; display: flex; align-items: center; justify-content: center; padding: 10px;">
                    <p id="reason-text" style="font-size: 1.1rem; color: #555;">‡∏•‡∏≠‡∏á‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏™‡∏¥‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏à‡∏∞‡∏ö‡∏≠‡∏Å...</p>
                </div>
            </div>
            <button class="btn-main" onclick="nextReason()">üíå ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å</button>
            <button id="next-to-3" class="btn-main btn-next hidden" onclick="goToStep(3)">‡∏ï‡πà‡∏≠‡πÑ‡∏õ: ‡∏≠‡∏±‡∏•‡∏ö‡∏±‡πâ‡∏°‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ üì∏</button>
        </div>

        <!-- Step 3: Gallery -->
        <div id="step-3" class="step-content hidden">
            <h2 style="color: var(--dark-pink); margin-bottom: 20px;">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏ó‡∏µ‡πà‡∏á‡∏î‡∏á‡∏≤‡∏° üì∏</h2>
            <div class="slider-container" id="slider">
                <div class="slider-track" id="slider-track">
                    <div class="slide"><img src="image/lovelove (1).jpg" alt="Memory 1" onerror="this.src='https://placehold.co/400x300?text=Memory+1'"></div>
                    <div class="slide"><img src="image/lovelove (2).jpg" alt="Memory 2" onerror="this.src='https://placehold.co/400x300?text=Memory+2'"></div>
                    <div class="slide"><img src="image/lovelove (3).jpg" alt="Memory 3" onerror="this.src='https://placehold.co/400x300?text=Memory+3'"></div>
                    <div class="slide"><img src="image/lovelove (4).jpg" alt="Memory 4" onerror="this.src='https://placehold.co/400x300?text=Memory+4'"></div>
                    <div class="slide"><img src="image/lovelove (5).jpg" alt="Memory 5" onerror="this.src='https://placehold.co/400x300?text=Memory+5'"></div>
                    <div class="slide"><img src="image/lovelove (6).jpg" alt="Memory 6" onerror="this.src='https://placehold.co/400x300?text=Memory+6'"></div>
                </div>
            </div>
            <p style="margin-top: 15px; font-size: 0.9rem; color: #999;">(‡∏•‡∏≠‡∏á‡∏õ‡∏±‡∏î‡∏ã‡πâ‡∏≤‡∏¢-‡∏Ç‡∏ß‡∏≤ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏†‡∏≤‡∏û‡∏ñ‡∏±‡∏î‡πÑ‡∏õ)</p>
            <button class="btn-main btn-next" onclick="goToStep(4)">‡∏ï‡πà‡∏≠‡πÑ‡∏õ: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥ üíò</button>
        </div>

        <!-- Step 4: Game -->
        <div id="step-4" class="step-content hidden">
            <h2 style="color: var(--dark-pink); margin-bottom: 10px;">‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏´‡∏±‡∏ß‡πÉ‡∏à üíò</h2>
            <p style="margin-bottom: 20px; font-size: 0.9rem;">‡∏´‡∏≤‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏à‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç!</p>
            <div class="game-grid" id="game-grid"></div>
            <button id="next-to-5" class="btn-main btn-next hidden" onclick="goToStep(5)">‡∏ï‡πà‡∏≠‡πÑ‡∏õ: ‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢ üéÅ</button>
        </div>

        <!-- Step 5: Surprise -->
        <div id="step-5" class="step-content hidden">
            <h2 style="color: var(--dark-pink); margin-bottom: 30px;">‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ò‡∏≠ üéÅ</h2>
            <div class="gift-box" id="gift-box" onclick="openGift()">üéÅ</div>
            <p id="gift-hint" style="margin-top: 20px;">‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡πÉ‡∏à...</p>
        </div>

        <!-- Final Reveal Wrapper -->
        <div id="final-wrapper" class="hidden">
            <header class="final-header">
                <div style="font-size: 5rem; margin-bottom: 20px;">‚ú®‚ù§Ô∏è‚ú®</div>
                <h1 style="color: var(--soft-red); font-size: 2.2rem;">Happy Valentine's Day</h1>
                <p id="final-partner-name" style="font-size: 1.2rem; color: var(--dark-pink);"></p>
                <div style="margin-top: 40px; animation: bounce 2s infinite;">
                    <p style="font-size: 0.8rem; color: #aaa;">‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤</p>
                    <div style="font-size: 1.5rem;">‚Üì</div>
                </div>
            </header>
            
            <div id="full-page-content"></div>
            
            <div class="step-content" style="background: white;">
                <h2 style="color: var(--soft-red);">‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡πÉ‡∏à ‚úç</h2>
                <div class="section-card">
                    <p>"‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏≠‡∏∞‡πÑ‡∏£‡∏Ç‡∏∂‡πâ‡∏ô ‡∏â‡∏±‡∏ô‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Ç‡πâ‡∏≤‡∏á‡πÜ ‡πÄ‡∏ò‡∏≠‡πÄ‡∏™‡∏°‡∏≠ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ô‡∏ô‡∏∞"</p>
                </div>
                <footer style="margin-top: 50px; color: #ccc; font-size: 0.8rem;">
                    Our Forever Story &copy; 2024
                </footer>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 5;
        const partnerName = "‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å"; // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ü‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
        const reasons = [
            "‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏ò‡∏≠‡∏¢‡∏¥‡πâ‡∏°‡πÅ‡∏•‡πâ‡∏ß‡πÇ‡∏•‡∏Å‡∏™‡∏î‡πÉ‡∏™‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å‡πÜ ‡πÄ‡∏•‡∏¢",
            "‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏ò‡∏≠‡∏Ñ‡∏≠‡∏¢‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡πÜ ‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏â‡∏±‡∏ô‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢",
            "‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏ò‡∏≠‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏â‡∏±‡∏ô‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞‡πÑ‡∏î‡πâ‡πÄ‡∏™‡∏°‡∏≠",
            "‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ò‡∏≠ ‡∏°‡∏±‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏â‡∏±‡∏ô‡∏ô‡∏∞",
            "‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏â‡∏±‡∏ô‡∏°‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ò‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏•‡πâ‡∏ß"
        ];
        let reasonCount = 0;

        // 1. Initial State
        function startStory() {
            const splash = document.getElementById('splash-screen');
            const audio = document.getElementById('bg-music');
            const btn = document.getElementById('music-btn');

            splash.style.opacity = '0';
            
            // Start music immediately upon user interaction
            audio.play().then(() => {
                btn.innerText = 'üéµ';
            }).catch(e => console.log("Audio play blocked", e));

            setTimeout(() => {
                splash.classList.add('hidden');
                document.getElementById('story-container').classList.remove('hidden');
                document.getElementById('progress-container').classList.remove('hidden');
                btn.classList.remove('hidden');
                updateProgress();
            }, 500);
        }

        // 2. Step Navigation
        function goToStep(step) {
            const currentEl = document.getElementById(`step-${currentStep}`);
            currentEl.classList.add('hidden');
            
            const nextEl = document.getElementById(`step-${step}`);
            nextEl.classList.remove('hidden');
            nextEl.classList.add('fade-in');
            
            currentStep = step;
            updateProgress();
            
            if(step === 4) initGame();
            if(step === 3) initSlider();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateProgress() {
            const percent = (currentStep / totalSteps) * 100;
            document.getElementById('progress-bar').style.width = percent + '%';
        }

        // 3. Reasons Randomizer
        function nextReason() {
            const txt = document.getElementById('reason-text');
            txt.style.opacity = '0';
            setTimeout(() => {
                txt.innerText = reasons[Math.floor(Math.random() * reasons.length)];
                txt.style.opacity = '1';
                createHeartEffect();
                reasonCount++;
                if(reasonCount >= 3) {
                    const btn = document.getElementById('next-to-3');
                    btn.classList.remove('hidden');
                    btn.classList.add('fade-in');
                }
            }, 300);
        }

        // 4. Memory Matching Game
        function initGame() {
            const icons = ['‚ù§Ô∏è', 'üíñ', 'üåπ', 'üß∏', '‚ù§Ô∏è', 'üíñ', 'üåπ', 'üß∏'];
            const shuffled = icons.sort(() => Math.random() - 0.5);
            const grid = document.getElementById('game-grid');
            grid.innerHTML = '';
            let flipped = [];
            let matched = 0;

            shuffled.forEach((icon, i) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `<div class="front">‚ùì</div><div class="back">${icon}</div>`;
                card.onclick = () => {
                    if(flipped.length < 2 && !card.classList.contains('flipped')) {
                        card.classList.add('flipped');
                        flipped.push(card);
                        if(flipped.length === 2) {
                            setTimeout(() => {
                                if(flipped[0].querySelector('.back').innerText === flipped[1].querySelector('.back').innerText) {
                                    matched++;
                                    createHeartEffect();
                                    if(matched === 4) {
                                        const btn = document.getElementById('next-to-5');
                                        btn.classList.remove('hidden');
                                        btn.classList.add('fade-in');
                                    }
                                } else {
                                    flipped.forEach(c => c.classList.remove('flipped'));
                                }
                                flipped = [];
                            }, 700);
                        }
                    }
                };
                grid.appendChild(card);
            });
        }

        // 5. Touch Slider (Updated for 6 slides)
        function initSlider() {
            const track = document.getElementById('slider-track');
            let startX = 0;
            let currentIdx = 0;
            const slidesCount = 6;

            track.addEventListener('touchstart', (e) => startX = e.touches[0].clientX);
            track.addEventListener('touchend', (e) => {
                const endX = e.changedTouches[0].clientX;
                if(startX - endX > 50 && currentIdx < slidesCount - 1) currentIdx++;
                if(startX - endX < -50 && currentIdx > 0) currentIdx--;
                track.style.transform = `translateX(-${currentIdx * 100}%)`;
                createHeartEffect();
            });
        }

        // 6. Gift & Final Reveal Logic
        function openGift() {
            const box = document.getElementById('gift-box');
            if(box.classList.contains('open')) return;
            
            box.innerText = 'üåπ';
            box.classList.add('open');
            document.getElementById('gift-hint').innerHTML = `‡∏£‡∏±‡∏Å ${partnerName} ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å‡πÄ‡∏•‡∏¢! ‚ù§Ô∏è`;
            
            for(let i=0; i<15; i++) setTimeout(createHeartEffect, i * 150);
            setTimeout(revealAllSections, 2500);
        }

        function revealAllSections() {
            document.body.classList.add('full-view-mode');
            
            const finalWrapper = document.getElementById('final-wrapper');
            const fullContent = document.getElementById('full-page-content');
            
            document.getElementById('final-partner-name').innerText = `‡∏ñ‡∏∂‡∏á... ${partnerName} ‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô`;

            // Move steps into the final summary
            for(let i=1; i<=5; i++) {
                const step = document.getElementById(`step-${i}`);
                step.classList.remove('hidden', 'fade-in');
                
                const btn = step.querySelector('.btn-next');
                if(btn) btn.classList.add('hidden');
                
                fullContent.appendChild(step);
            }

            finalWrapper.classList.remove('hidden');
            document.getElementById('progress-container').classList.add('hidden');
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // 7. Core Effects
        function createHeartEffect() {
            const h = document.createElement('div');
            h.className = 'floating-heart';
            h.innerText = ['‚ù§Ô∏è','üíñ','üíó','üíï'][Math.floor(Math.random()*4)];
            h.style.left = Math.random() * 80 + 10 + 'vw';
            h.style.top = '60vh';
            document.body.appendChild(h);
            setTimeout(() => h.remove(), 2500);
        }

        function toggleMusic() {
            const m = document.getElementById('bg-music');
            const btn = document.getElementById('music-btn');
            if(m.paused) { 
                m.play().catch(e => console.log("Audio play blocked"));
                btn.innerText = 'üéµ'; 
            } else { 
                m.pause(); 
                btn.innerText = 'üîá'; 
            }
        }
    </script>
</body>
</html>